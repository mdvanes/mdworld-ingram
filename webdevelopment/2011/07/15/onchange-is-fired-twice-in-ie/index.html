<!DOCTYPE html><!--[if lt IE 9]> <html class="lt-ie9" lang="en"> <![endif]--><!--[if IE 9]>    <html class="ie9" lang="en"> <![endif]--><!--[if gt IE 9]><!--><html xmlns=http://www.w3.org/1999/xhtml class=gt-ie9 lang=en><!--<![endif]--><head><!-- version 0.3.5 --><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge,chrome=1"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><meta name=author content="mdworld 0.3.5"><title>Onchange Is Fired Twice In IE</title><link rel="shortcut icon" href=/mdworld-ingram/img/favicon.ico type=image/x-icon><link rel=stylesheet href=/mdworld-ingram/css/all.css></head><body><div class=site><nav class="navbar navbar-inverse navbar-fixed-top"><div><div class=container><div class=row><ul class="nav navbar-nav navbar-right"><li><a href=/mdworld-ingram/ ><span class="glyphicon glyphicon-home"></span> home</a></li><li><a href=/mdworld-ingram/#blog><span class="glyphicon glyphicon-pencil"></span> blog</a></li><li><a href=https://twitter.com/mdworldNL><span class=twitter></span> <span class=label-optional>@mdworldNL</span></a></li><li><a href=# data-toggle=modal data-target=#contactModal><span class="glyphicon glyphicon-envelope"></span> <span class=label-optional>contact</span></a></li></ul></div></div></div><header><h1 class="title post-title container">Onchange Is Fired Twice In IE</h1></header></nav><p class="meta container">15 Jul 2011</p><div class="post container"><div class=multi-column-text><p>Ahhh, this is the life: struggling for days with some obscure IE bug.</p><p>I have an onchange attribute with a jQuery AJAX call on a HTML dropdown that gives strange errors. But only in IE (8, didn&#39;t try it in other versions). When replacing the AJAX call with an alert, like so:</p><figure class=highlight><pre><code class=language-html data-lang=html><span class=nt>&lt;select</span> <span class=na>onchange=</span><span class=s>"alert('onchange');"</span><span class=nt>&gt;</span>...<span class=nt>&lt;/select&gt;</span></code></pre></figure><p>it becomes clear that the onchange is triggered twice. This was also confirmed in the IE Developer Tools window, but I can&#39;t use that to debug further.</p><p>After gradually commenting out included javascript libraries, I found the cause must have something to do with a an jQuery bind of the onchange event. Besides the onchange in the HTML, this library initializes all select boxes to have some alternative styling. To do that, jQuery also binds an onchange using the <a href=http://api.jquery.com/change/ >.change function</a>.</p><p>Apparently, after this .change binding is done, IE8 triggers the HTML onchange, twice.</p><p>My first approach to solve this generically is to automatically convert HTML onchange attributes to jQuery .change bindings. I tried to &quot;copy&quot; the onchange from the HTML attribute to jQuery using:</p><figure class=highlight><pre><code class=language-js data-lang=js><span class=kd>var</span> <span class=nx>x</span> <span class=o>=</span> <span class=nx>dropdown</span><span class=p>.</span><span class=nx>attr</span><span class=p>(</span><span class=s2>"onchange"</span><span class=p>);</span>
<span class=nx>dropdown</span><span class=p>.</span><span class=nx>change</span><span class=p>(</span>
<span class=kd>function</span><span class=p>()</span>
  <span class=p>{</span>
    <span class=nb>eval</span><span class=p>(</span><span class=nx>x</span><span class=p>);</span>
  <span class=p>}</span>
<span class=p>)</span></code></pre></figure><p>Unfortunately this gave some unexpected behaviour in IE7, because where dropdown.attr(&quot;change&quot;) returns this in IE7:</p><figure class=highlight><pre><code class=language-js data-lang=js><span class=nx>alert</span><span class=p>(</span><span class=s2>"onchange"</span><span class=p>)</span></code></pre></figure><p>In FF en IE8 it returns:</p><figure class=highlight><pre><code class=language-js data-lang=js><span class=kd>function</span><span class=p>()</span>
<span class=p>{</span>
  <span class=nx>alert</span><span class=p>(</span><span class=s2>"onchange"</span><span class=p>);</span>
<span class=p>}</span></code></pre></figure><p>In other words: don&#39;t mix the HTML onchange attribute and jQuery onchange binding (unless you don&#39;t care to support IE).</p><p>Now I&#39;ve fully migrated all onchange behaviour to multiple jQuery binds, only leaving a CSS class (e.g. &#39;alert&#39;) in the HTML, and then tracking dropdowns with that class:</p><figure class=highlight><pre><code class=language-js data-lang=js><span class=nx>jQuery</span><span class=p>.</span><span class=nx>each</span><span class=p>(</span><span class=nx>jQuery</span><span class=p>(</span><span class=s2>"select.alert"</span><span class=p>),</span> <span class=kd>function</span><span class=p>(){</span>
  <span class=nx>jQuery</span><span class=p>(</span><span class=k>this</span><span class=p>).</span><span class=nx>unbind</span><span class=p>(</span><span class=s2>"change.alert"</span><span class=p>);</span>
  <span class=nx>jQuery</span><span class=p>(</span><span class=k>this</span><span class=p>).</span><span class=nx>bind</span><span class=p>(</span><span class=s2>"change.alert"</span><span class=p>,</span> <span class=kd>function</span><span class=p>(){</span>
    <span class=nx>alert</span><span class=p>(</span><span class=s2>"onchange"</span><span class=p>);</span>
  <span class=p>});</span>
<span class=p>});</span></code></pre></figure><p>I am using a <a href=http://docs.jquery.com/Namespaced_Events>namespaced bind</a> (the &#39;.alert&#39; suffix to the &#39;change&#39; string in the more generic <a href=http://api.jquery.com/bind/ >.bind function</a>, instead of using just .change). This makes it possible to just unbind this onchange function, and leave other onchange functions bound. This is required, because I also do an unbind right before the bind. This is to prevent multiple binds after the AJAX request.</p></div></div><div class="modal fade modal-terminal" id=contactModal tabindex=-1 role=dialog aria-labelledby=contactModalLabel aria-hidden=true><div class=modal-dialog><div class=modal-content><div class=modal-header><button type=button class=close data-dismiss=modal><span aria-hidden=true>&times;</span><span class=sr-only>Close</span></button><h4 class=modal-title id=myModalLabel>contact@mdworld</h4></div><div class=modal-body><form role=form id=contactForm><div class=form-group><label for=contactName>Name</label><input class=form-control id=contactName placeholder="Enter name" name=name required maxlength=1024></div><div class=form-group><label for=contactEmail>Email address</label><input type=email class=form-control id=contactEmail placeholder="Enter email" name=email required maxlength=1024></div><div class=form-group><label for=contactMessage>Message</label><textarea class=form-control id=contactMessage placeholder=Message name=message required maxlength=4096></textarea></div><button type=button class="btn btn-primary submit-contact">Submit</button></form></div></div></div></div><footer><div class="content container"><div class="row projects"><div class="col-xs-12 col-xl-4 col-xl-offset-2"><h2>Open Source by MDWorld</h2></div></div><div class="row projects"><div class="col-xs-12 col-sm-6 col-xl-4 col-xl-offset-2"><div class=media-wrapper><a class=media href=https://github.com/mdvanes/polygram><span class="pull-left icon github"></span><div class=media-body><h4 class=media-heading>polygram</h4>Polymer and Redux App</div></a></div><div class=media-wrapper><a class=media href=https://github.com/mdvanes/mdworld-pwa-demo><span class="pull-left icon github"></span><div class=media-body><h4 class=media-heading>mdworld-pwa-demo</h4>Progressive Web App demo</div></a></div><div class=media-wrapper><a class=media href=https://bitbucket.org/mdvanes/homeremote><span class="pull-left icon bitbucket"></span><div class=media-body><h4 class=media-heading>HomeRemote</h4>ES6 React and Node Home automation tool</div></a></div><div class=media-wrapper><a class=media href=https://github.com/mdvanes/generator-mdworld-toolchain><span class="pull-left icon github"></span><div class=media-body><h4 class=media-heading>generator-mdworld-toolchain</h4>Yeoman generator to set up the mdworld toolchain</div></a></div><div class=media-wrapper><a class=media href=http://mdvanes.github.io/ImpossibleObjects/ ><span class="pull-left icon github"></span><div class=media-body><h4 class=media-heading>ImpossibleObjects</h4>A selection of impossible objects using Canvas</div></a></div><div class=media-wrapper><a class=media href=https://github.com/mdvanes/grunt-kot2html><span class="pull-left icon github"></span><div class=media-body><h4 class=media-heading>grunt-kot2html</h4>Grunt task to combine Knockout templates into one HTML</div></a></div><div class=media-wrapper><a class=media href=https://github.com/mdvanes/grunt-kot2js><span class="pull-left icon github"></span><div class=media-body><h4 class=media-heading>grunt-kot2js</h4>Grunt task to convert Knockout templates to a JavaScript file</div></a></div></div><div class="col-xs-12 col-sm-6 col-xl-4"><div class=media-wrapper><a class=media href=https://github.com/mdvanes/mdworld-stox><span class="pull-left icon github"></span><div class=media-body><h4 class=media-heading>mdworld-stox</h4>Websockets in Node.js demo</div></a></div><div class=media-wrapper><a class=media href=https://github.com/mdvanes/SynergyChrome><span class="pull-left icon github"></span><div class=media-body><h4 class=media-heading>SynergyChrome</h4>Use Synergy in Chrome</div></a></div><div class=media-wrapper><a class=media href=https://github.com/mdvanes/Movienight><span class="pull-left icon github"></span><div class=media-body><h4 class=media-heading>Movienight</h4>PoC for hybrid app with Ionic Framework</div></a></div><div class=media-wrapper><a class=media href=https://bitbucket.org/mdvanes/mderekelbox><span class="pull-left icon bitbucket"></span><div class=media-body><h4 class=media-heading>Rekelbox</h4>Arduino VU meter</div></a></div><div class=media-wrapper><a class=media href=https://bitbucket.org/mdvanes/mdepolska><span class="pull-left icon bitbucket"></span><div class=media-body><h4 class=media-heading>MDE Polska</h4>Polish keyboard Drupal module</div></a></div><div class=media-wrapper><a class=media href=https://bitbucket.org/mdvanes/mdegraph><span class="pull-left icon bitbucket"></span><div class=media-body><h4 class=media-heading>MDE Graph</h4>Javascript Graph PoC</div></a></div><div class=media-wrapper><a class=media href=https://bitbucket.org/mdvanes/mdeinsignificant><span class="pull-left icon bitbucket"></span><div class=media-body><h4 class=media-heading>Insignificant!</h4>loltext generator Drupal module</div></a></div></div></div><div class=row><h1 class=dedication>an MDWorld production</h1><p><a class=cc href=http://creativecommons.org/licenses/by-nc-sa/3.0/ title="Creative Commons">CC</a> 2003-2018</p></div></div></footer></div><!-- .site --><script src=/mdworld-ingram/js/scripts.js></script><!-- Run init for demo after loading jquery --><script>if(typeof(demoInit) === 'function') {
                demoInit();
            }</script></body></html>